---
title: ì›¹ í´ë¦­ìŠ¤íŠ¸ë¦¼ ìˆ˜ì§‘í•˜ê¸° 1) íŒ ë²Œë¦¬ê¸°
description: ì¹´í”„ì¹´ë‘ í•˜ë‘¡ ì¨ì„œ í• ë§Œí•œ í”„ë¡œì íŠ¸ ê³„íší•˜ê¸°
author: annmunju
date: 2025-05-20 17:50:00 +0900
categories: [Ingest-web-click-log, poc]
tags: [data, log, ingest]
pin: true
math: true
mermaid: true
comments: true
---

> ë¬´ì§ ë°±ìˆ˜ëŠ” ì¹´í”„ì¹´ë‘ í•˜ë‘¡ì„ ì–´ë–»ê²Œ í˜¼ì ì‹¤ìŠµí•˜ì§€..?

ë°ì—” ì·¨ì—… ì¤€ë¹„í•˜ëŠ” ë°±ìˆ˜ì¸ ì €ëŠ” ì¹´í”„ì¹´ì™€ í•˜ë‘¡ì„ ì§ì ‘ ì‚¬ìš©í•´ì„œ ìµíˆëŠ” ê²½í—˜ì„ í•˜ê³  ì‹¶ì–´ ì•„ì£¼ ì‘ì€ PoCë¥¼ ë§Œë“¤ì–´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.

GPTì˜ ë„ì›€ì„ ë°›ì•„, ì–´ë–¤ í”„ë¡œì íŠ¸ê°€ ì¢‹ì„ì§€ ê³ ë¯¼í•˜ì˜€ê³  **ì‹¤ì‹œê°„ ì›¹ í´ë¦­ìŠ¤íŠ¸ë¦¼ ë¡œê·¸ ìˆ˜ì§‘Â·ì €ì¥Â·ë°°ì¹˜ë¶„ì„ íŒŒì´í”„ë¼ì¸**ìœ¼ë¡œ ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

## ğŸ¯ PoC ëª©í‘œ

- ê°œì¸ ë¸”ë¡œê·¸ë¥¼ í†µí•´ **í´ë¦­ìŠ¤íŠ¸ë¦¼ ë¡œê·¸ ë°ì´í„° ìƒì„±**
- í•´ë‹¹ í´ë¦­ ë¡œê·¸ë¥¼ **Kafkaì— ì‹¤ì‹œê°„ ì „ë‹¬**
- Kafka Connect HDFS ì»¤ë„¥í„°ë¥¼ ì´ìš©í•´ í† í”½ì— ìŒ“ì¸ ë©”ì‹œì§€ë¥¼ ì¼ì • ì£¼ê¸°(ex. 5ë¶„)ë¡œ **HDFSì— íŒŒì¼ë¡œ ì €ì¥**
- HDFSì— ì ì¬ëœ ë¡œê·¸ íŒŒì¼ì„ ëŒ€ìƒìœ¼ë¡œ **ë°°ì¹˜ ë¶„ì„ ì‹¤í–‰**

## ì‚¬ì „ ì¤€ë¹„

1. [ê°œì¸ ë¸”ë¡œê·¸ ë¨¼ì € ì¤€ë¹„](#1-%EA%B0%9C%EC%9D%B8-%EB%B8%94%EB%A1%9C%EA%B7%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0): github.io ë¸”ë¡œê·¸
2. [í´ë¦­ ë¡œê·¸ ë°›ì•„ì¤„ Ingest ì„œë²„ ë„ìš°ê¸°](#2-ingest-%EC%84%9C%EB%B2%84-%EB%A7%8C%EB%93%A4%EA%B8%B0)
3. [github pages í”„ë¡ íŠ¸ì— JS ìŠ¤ë‹ˆí« ì‹¬ê¸°](#3-%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%90-js-%EC%8A%A4%EB%8B%88%ED%8E%AB-%EC%8B%AC%EA%B8%B0)

### 1. ê°œì¸ ë¸”ë¡œê·¸ ë§Œë“¤ê¸°

Jekyll ì˜¤í”ˆì†ŒìŠ¤ í…Œë§ˆ chirpyë¥¼ í¬í¬í•´ì„œ ë‚´ ê¹ƒí—ˆë¸Œ í˜ì´ì§€ì— `annmunju.github.io` ë ˆí¬ì§€í† ë¦¬ì— pagesë¥¼ ë„ìš°ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. 

#### 1.0 Jekyll ì„¤ì¹˜
M1 ë§¥ë¶ì„ ì‚¬ìš©í•˜ê³  ìˆì–´ì„œ ë‹¤ìŒê³¼ ê°™ì€ ê²Œì‹œê¸€ì„ ì°¸ê³ í•´ ì„¤ì¹˜í•˜ì˜€ìŠµë‹ˆë‹¤.
[M1 mac - Jekyll blog í™˜ê²½ ì„¸íŒ…í•˜ê¸°](https://danaing.github.io/etc/2022/03/14/M1-mac-jekyll-setting.html)

#### 1.1 í…Œë§ˆ í¬í¬
[chirpy-starter ë ˆí¬](https://github.com/cotes2020/chirpy-starter)ì—ì„œ í…œí”Œë¦¿ì„ ê°€ì ¸ì™€ ë‚´ ìƒˆë¡œìš´ ë ˆí¬ë¥¼ ë§Œë“­ë‹ˆë‹¤.
![í…œí”Œë¦¿ ë ˆí¬ ë§Œë“¤ê¸°](assets/img/posts/2025-05-21-íŒ-ë²Œë¦¬ê¸°/01.png)

#### 1.2 ë¡œì»¬ í´ë¡  ë° _config.yml ìˆ˜ì •
```bash
git clone git@github.com:annmunju/annmunju.github.io.git
cd annmunju.github.io
```
ìœ„ì™€ ê°™ì´ ê²½ë¡œ ì´ë™ í›„ _config.yml íŒŒì¼ì— í•„ìš”í•œ ì •ë³´ë¥¼ ë„£ì–´ì¤ë‹ˆë‹¤.
- url ì¶”ê°€ (ê¹ƒí—ˆë¸Œ ê²½ë¡œ)
- ì–¸ì–´ ë³€ê²½: _data/localesì— ko-KR.yml íŒŒì¼ ì¶”ê°€, _config.yml íŒŒì¼ì— langì„ ko-KRë¡œ ìˆ˜ì •
- timezoneì„ Asia/Seoulë¡œ ë°˜ì˜
- title, tagline, description ì¶”ê°€
- íŠ¸ìœ„í„° ì‚­ì œ, github ì¶”ê°€, emailê³¼ ë§í¬ ê²½ë¡œ ìˆ˜ì •
- í”„ë¦¬ë·° ì•„ë°”íƒ€ ì´ë¯¸ì§€ ì¶”ê°€ (social_preview_image)
- ëŒ“ê¸€ ê¸°ëŠ¥ ì¶”ê°€ (disqus ê³„ì • ìƒì„±)
```yml
comments:
    provider: disqus 
    disqus:
        shortname: annmunju-github-blog 
```

#### 1.3 github pages ì„¤ì •
ìœ„ì˜ chirpy-starterëŠ” chripyë¼ëŠ” í…Œë§ˆì—ì„œ ê°€ì¥ ê¸°ë³¸ì ì¸ ì‚¬í•­ë§Œ ì ìš©ëœ ë²„ì „ì…ë‹ˆë‹¤. ê·¸ë ‡ì§€ë§Œ [github actions ë©”ë‹ˆí˜ìŠ¤í†  íŒŒì¼](https://github.com/cotes2020/chirpy-starter/blob/main/.github/workflows/pages-deploy.yml)ì´ ì‘ì„±ë˜ì–´ ìˆì–´ì„œ githubì— pushí•˜ë©´ ìë™ìœ¼ë¡œ ë°°í¬(CD)í•  ìˆ˜ ìˆê²Œ ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ì´ë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •ì— ë°°í¬ ì†ŒìŠ¤ë¥¼ github actionsë¡œ ì„¤ì •í•´ì¤ë‹ˆë‹¤.
![github pages ì„¤ì •](assets/img/posts/2025-05-21-íŒ-ë²Œë¦¬ê¸°/02.png)

ê·¸ëŸ¼ ìë™ìœ¼ë¡œ main í˜¹ì€ master ë¸Œëœì¹˜ë¡œ pushí•  ë•Œ í˜ì´ì§€ê°€ ë°°í¬ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
![github actions](assets/img/posts/2025-05-21-íŒ-ë²Œë¦¬ê¸°/03.png)

### 2. Ingest ì„œë²„ ë§Œë“¤ê¸°
ë‹¤ìŒì€ Ingest ì„œë²„ ì—­í• ì„ í•  lambdaë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ìš°ì„ ì€ kafkaë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë‹¨ìˆœí•˜ê²Œ í´ë¦­ìŠ¤íŠ¸ë¦¼ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

ìš°ì„  ì½˜ì†”ë¡œ ì‘ì—…í•˜ê³  ì´í›„ì— êµ¬ì²´ì ì¸ ì¸í”„ë¼ í™˜ê²½ì„ ì •ì˜í•œ í›„ Terraformì„ ì´ìš©í•´ IaCë¡œ ê´€ë¦¬í•  ê³„íšì…ë‹ˆë‹¤.

#### 2.1 IAM ì—­í• 
ëŒë‹¤ëŠ” CloudWatch Logs ì‘ì„± ê¶Œí•œì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— í•„ìš”í•œ ê¶Œí•œì„ ì¶”ê°€í•œ ì—­í• ì„ ìƒì„±í•©ë‹ˆë‹¤.
<div style="display: flex; justify-content: center; gap: 2%;">
  <img src="assets/img/posts/2025-05-21-íŒ-ë²Œë¦¬ê¸°/04.png" alt="ì—­í•  ìƒì„± 1ë‹¨ê³„">
  <img src="assets/img/posts/2025-05-21-íŒ-ë²Œë¦¬ê¸°/05.png" alt="ì—­í•  ìƒì„± 2ë‹¨ê³„">
</div>

#### 2.2 Lambda í•¨ìˆ˜
í•¨ìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
![github actions](assets/img/posts/2025-05-21-íŒ-ë²Œë¦¬ê¸°/06.png)
í•¨ìˆ˜ì˜ ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.
```python
import json
import logging

logger = logging.getLogger()
logger.setLevel(logging.INFO)

def lambda_handler(event, context):
    # API Gateway HTTP APIë¥¼ ì‚¬ìš©í•˜ì—¬ event['body']ì— í˜ì´ë¡œë“œê°€ ë“¤ì–´ì˜µë‹ˆë‹¤.
    try:
        payload = json.loads(event.get('body', '{}'))
    except json.JSONDecodeError:
        payload = {"raw": event.get('body')}
    logger.info(f"Received click event: {payload}")
    return {
        "statusCode": 200,
        "headers": {"Content-Type": "application/json"},
        "body": json.dumps({"status": "ok", "received": payload})
    }
```

#### 2.3 API Gateway HTTP API ìƒì„±
ì´ë²ˆì—” ëŒë‹¤ë¡œ ì ‘ê·¼í•˜ê¸° ìœ„í•œ API ê²Œì´íŠ¸ì›¨ì´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ìš°ì„  ì½˜ì†”ì—ì„œ API Gateway ê²€ìƒ‰ í›„ HTTP APIë¡œ apië¥¼ ìƒì„±í•©ë‹ˆë‹¤.
ìë™ ë°°í¬($default)ë¥¼ ì ìš©í•´ ëŒë‹¤ê°€ ìˆ˜ì •ë˜ë©´ ì¦‰ì‹œ ë°˜ì˜ë©ë‹ˆë‹¤.
<div style="display: flex; justify-content: center; gap: 2%;">
  <img src="assets/img/posts/2025-05-21-íŒ-ë²Œë¦¬ê¸°/07.png" alt="http api ìƒì„±">
  <img src="assets/img/posts/2025-05-21-íŒ-ë²Œë¦¬ê¸°/08.png" alt="ê²€í†  ë° ìƒì„±">
</div>
ë¸Œë¼ìš°ì €ë¡œ ë‹¤ë¥¸ ë„ë©”ì¸(í”„ë¡ íŠ¸ì—”ë“œ)ì—ì„œ API Gatewayë¡œ ì§ì ‘ ìš”ì²­í•  ë•Œ ë³´ì•ˆ ì •ì±…(CORS)ì— ì˜í•´ ì°¨ë‹¨ë˜ì§€ ì•Šë„ë¡ í—ˆìš© ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤. CORS ì„¤ì •ì€ ì•„ë˜ì™€ ê°™ì´ ì§„í–‰í•©ë‹ˆë‹¤.
![CORS](assets/img/posts/2025-05-21-íŒ-ë²Œë¦¬ê¸°/09.png)

#### 2.4 curl í…ŒìŠ¤íŠ¸
```bash
curl -X POST \
  -H "Content-Type: application/json" \
  -d '{"path":"/test","tag":"A","id":null,"timestamp":"2025-05-21T12:00:00Z"}' \
   https://{ì£¼ì†Œ}.execute-api.ap-northeast-2.amazonaws.com/ingest
```
Invoke URLë¡œ í…ŒìŠ¤íŠ¸í•´ë³¸ ê²°ê³¼ ì •ìƒ ì‘ë‹µì´ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. :)
```
# result
{"status": "ok", "received": {"path": "/test", "tag": "A", "id": null, "timestamp": "2025-05-21T12:00:00Z"}}
```

### 3. í”„ë¡ íŠ¸ì— JS ìŠ¤ë‹ˆí« ì‹¬ê¸°

#### github actionsì— Secrets ì¶”ê°€
