---
title: solvesql 문제 풀이
description: 문제 풀이 목록
author: annmunju
date: 2025-06-25 14:35:00 +0900
categories: [tech-deep-dives, sql]
tags: [sql]
pin: false
math: true
mermaid: false
comments: false
---

### 난이도 2

1. [언더스코어 포함되지 않은 데이터 찾기](https://solvesql.com/problems/data-without-underscore/)

```sql
select distinct page_location
from ga
where page_location not like "%\_%" escape "\"
order by page_location;
```

- 특수문자의 경우 이스케이프 문자 포함해서 찾고, escape 작성해주기

2. [게임 10개 이상 발매한 배급사 찾기](https://solvesql.com/problems/publisher-with-many-games/)

- 제출한 답 (직관성과 가독성 떨어짐짐)
```sql
select name
from (select publisher_id
    from games
    group by publisher_id
    HAVING count(game_id) >= 10) g
inner join companies c
on g.publisher_id = c.company_id;
```

- 개선한 답
```sql
select c.name
from games g
join companies c on g.publisher_id = c.company_id
group by c.name
having count(g.game_id) >= 10;
```

3. [기증품 비율 계산하기](https://solvesql.com/problems/ratio-of-gifts/)

```sql
select round((count(*) * 100.0 / a.a_cnt), 3)
from artworks as g join (select count(*) as a_cnt from artworks) as a
where credit like "%gift%";
```

- 정수 계산시 소수점 나타나지 않음 -> 실수 계산을 위해 100.0 곱셈 한 후 계산

4. [3년간 들어온 소장품 집계하기](https://solvesql.com/problems/summary-of-artworks-in-3-years/)

```sql
with year_artworks as (
  select substring(acquisition_date, 1, 4) as year, *
  from artworks
)
select 
  classification, 
  count(artwork_id) filter (where year = '2014') as "2014",
  count(artwork_id) filter (where year = '2015') as "2015",
  count(artwork_id) filter (where year = '2016') as "2016"
from year_artworks
group by classification
order by classification;
```

- 비슷한 다른 풀이

```sql
  count(case when year = '2014' then artwork_id end) as '2014',
  count(case when year = '2015' then artwork_id end) as '2015',
  count(case when year = '2016' then artwork_id end) as '2016'
```

- pivot 테이블 만들듯 컬럼에 해당 조건 넣어서 그에 맞는 열 생성

### 난이도 3

1. [복수 국적 메달 수상한 선수 찾기](https://solvesql.com/problems/multiple-medalist/)

```sql
with tmp as (select DISTINCT athlete_id, game_id, team_id, name
from records r 
  join teams t on r.team_id = t.id
  join games g on r.game_id = g.id
  join athletes a on r.athlete_id = a.id
where (year >= 2000) and (medal is not null))

select name
from tmp
group by athlete_id
having count(DISTINCT team_id) >= 2
order by name;
```

